{% extends "base_teacher.html" %}
{% load static %}
{% block content %}
    

      <div class="body-wrapper">
        <div class="container">
          <div class="row">
       
                <div class="col-lg-4 col-md-6">
                    <div class="card text-center">
                        <div class="card-body">
                            <img src="{% static '/assets/images/profile/calculator.png' %}" class="rounded-1 img-fluid" width="90" />
                            <div class="container">
                                <div id="quiz-list" class="mt-4"></div>
                            </div>
                            </div>
                            <br>
                            <a id="redirect-link" style="display:none;" href="question_teacher/"></a>
                        </div>
                    </div>
                </div>

      
        </div>
        
        
        </div>
      </div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
    const apiBaseUrl = "https://jetmind.uz/api/v1/quiz/";
    const quizListContainer = document.getElementById("quiz-list");
    const redirectLink = document.getElementById("redirect-link");

    // Test ro'yxatini olish
    fetch(apiBaseUrl + "sciences/list/")
        .then((response) => response.json())
        .then((data) => {
            data.forEach((quiz) => {
                const quizDiv = document.createElement("div");
                quizDiv.classList.add("card", "mb-3");

                quizDiv.innerHTML = `
                    <div class="card-body">
                        <h3 class="card-title">${quiz.name}</h3>
                        <p><strong>Davomiylik:</strong> ${quiz.duration_in_minutes} daqiqa</p>
                        <p><strong>Boshlanish sanasi:</strong> ${new Date(quiz.start_date).toLocaleString()}</p>
                        <p><strong>Tugash sanasi:</strong> ${new Date(quiz.end_date).toLocaleString()}</p>
                        <button class="btn btn-primary d-block w-100" onclick="startQuiz(${quiz.id})">Testlar</button>
                    </div>
                `;

                quizListContainer.appendChild(quizDiv);
            });
        })
        .catch((error) => console.error("Error fetching quiz list:", error));

    // Testni boshlash
    window.startQuiz = function (quizId) {
        fetch(apiBaseUrl + `quizzes/${quizId}/`, {
            method: "POST",
        })
            .then((response) => response.json())
            .then(() => {
                // Sahifaga yo'naltirish
                redirectLink.href = `/question_teacher/?id=${quizId}`;
                redirectLink.click();
            })
            .catch((error) => console.error("Error starting quiz:", error));
    };
});

</script>
{% endblock content %}